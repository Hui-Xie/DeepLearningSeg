=============training from sratch============
Program ID: 18170

Program command: 
 ['TrainSegV3d_ROI.py', '/home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI', '1', '/home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/nrrd_npy', '/home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/labels_npy', '1', '3,2,1']

Major program changes: 
      1  3D V model for primary cancer ROI;
      2  Uniform ROI size: 51*171*171 in z,y,x directon;
      3  Total 36 patient data, in which training data 24 patients, validation 6 patients, and test 6 patients;
      4  all 36 patients data have 50-80% 3D label;
      5  Dice coefficient is 3D dice coefficient against corresponding 3D ground truth;
      6  training data augmentation in the fly: affine in XY plane, translation in Z direction;
      7  In the bottle neck of V model, the latent vector has size of 512*2*9*9;
      Sep 16th, 2019:
      1   add dynamic loss weight according trainin  data;
      2   refine learning rate decay.
      Sep 21st, 2019
      1   add improved Boundary Loss2, and inherit the previous learningrate of network of pure CELoss;
      Sep 23rd, 2019:
      1   improve mean of boundary loss limited on the A,B regions;
      2   use log(segProb) instead of segProb in the boudary loss;
      3   CrossEntropy weight reduces 0.01 per 5 epochs from 1 to 0.01, while boundary Loss weight increase 0.01 per 5 epochs from 0.01 to 1. 
      Sep 24th, 2019
      1   Use boundaryLoss1, which is considering the whole volume. 
      Sep 25th, 2019
      1   use boundaryLoss3, which is a stronger gradient signal to improve loss.
      2   unbalanced weight for class is applied on logP,and just use boundaryLoss3 with CELoss.
      3   use CELoss and boundaryLoss together.
      4   Use truncated DistanceCrossEntropy Loss alone;
      5   change LRScheduler into reduce into Plateau with initial LR=0.1
      Sep 26th, 2019
      1   Add one layer in the bottom of V model;
      2   Add residual connnection in each layer;
      Sep 30th, 2019
      1   With size-reduced ROI of size 51*149*149;
      2   reduce the translation of data augmentation;
      3   reduce all data into 35 patients, excluding a very blur patient.
      Oct 5th, 2019
      1   use uniform physical size 147mm*147mm*147mm, input pixel size: 49*147*147 with spacing size 3mm*1mm*1mm;
      2   change V model with inputsize 49*147*147
      Oct 6th, 2019
      1   add filter number to 48 at the first layer. 
      Oct 7th, 2019
      1   restore to 32 of number of filters in the first layer;
      2   add bottom number of filters to 1024, and keep down sample and add filter number together. 
      Oct 8th, 2019
      1   discard the cancer with size exceeding 147mm*147mm*147mm; Now remains 29 patients data; 
      Oct 9th, 209
      1   In the first layer of V model, remove the residual link; 
           with the residula link at first layer: Tr dice:54%, Validation Dice 27%, Test Dice 56%;  Not good.
      2   the final output layer, change into 1*1*1 convolution, instead of 3*3*3 convolution;
          
         

Discarded changes:                  
          

Program starting Time: 2019-10-09 13:47:53.944670
Info: netPath = /home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI/20191009_134753

Info: this is the 1th fold leave for test in the 6-fold cross-validation.

Info: batchSize = 6

Net parameters is saved in  /home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI/20191009_134753.
6-fold cross validation: the 1th fold is for test, the 2th fold is for validation, remaining folds are for training.

training dataset: total 19 image files.

validation dataset: total 5 image files.

test dataset: total 5 image files.
Total 19 training files  extracted from /home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/labels_npy
0 has 18657366 elements, with a rate of  0.9273976277637033 
1 has 1460613 elements, with a rate of  0.0726023722362967 
loss weight = tensor([ 1.0000, 12.7737])
Network has total 113,191,074 parameters.


************** Table of Training Log **************
Epoch	LearningRate		TrainingLoss	Dice		ValidationLoss	Dice		TestLoss	Dice
0	1.0000e-02		13.9869		0.07646		1609.7452		0.00000		489.8737		0.00000
5	1.0000e-02		8.4267		0.30245		63.4364		0.29284		5.7963		0.14784
10	1.0000e-02		6.8185		0.36113		38.9749		0.27644		6.9016		0.14854
15	1.0000e-02		5.8598		0.37606		10.8700		0.38299		5.2236		0.18613
20	1.0000e-02		5.2230		0.39698		7.7136		0.36774		5.4181		0.18711
25	1.0000e-02		4.3721		0.43856		7.1989		0.39896		4.9941		0.24021
30	1.0000e-02		5.9445		0.41009		7.4174		0.37495		4.1786		0.22182
35	1.0000e-02		4.4450		0.38210		10.3276		0.45140		2.8718		0.25298
40	1.0000e-02		4.1871		0.39874		6.5182		0.46433		3.2378		0.22243
45	1.0000e-02		3.4785		0.47632		6.7865		0.46617		2.9149		0.23597
50	1.0000e-02		4.1188		0.47971		8.5526		0.53704		3.8504		0.22811
55	1.0000e-02		3.7583		0.43782		5.7978		0.41125		3.6932		0.21577
60	1.0000e-02		6.2162		0.41540		5.8774		0.52416		2.4953		0.24404
65	1.0000e-02		7.9344		0.41605		18.3990		0.35003		4.7628		0.22411
70	1.0000e-02		4.8941		0.40506		7.2606		0.40615		4.8822		0.21908
75	1.0000e-02		4.3986		0.42495		9.7135		0.43720		5.3039		0.18389
80	1.0000e-02		3.1325		0.45314		4.9243		0.50216		2.8421		0.23841
85	1.0000e-02		3.6836		0.47167		9.8435		0.45985		3.1240		0.24393
90	1.0000e-02		3.8992		0.40565		6.7328		0.57124		4.1947		0.22525
95	1.0000e-02		2.8319		0.46903		8.5813		0.43417		3.4386		0.23382
100	1.0000e-02		4.5752		0.49437		5.9440		0.44432		3.6018		0.23614
105	1.0000e-02		2.8708		0.46626		5.1678		0.53634		3.0841		0.25686
110	1.0000e-02		2.7575		0.43637		6.2610		0.48727		2.7855		0.24852
115	1.0000e-02		2.8654		0.45142		5.6306		0.47914		3.0375		0.24578
120	1.0000e-02		2.6367		0.49839		6.7481		0.48933		2.9570		0.24242
125	1.0000e-02		3.3712		0.43006		9.9022		0.50426		3.9304		0.28029
130	1.0000e-02		2.8218		0.51202		4.5699		0.48846		2.0780		0.27763
135	1.0000e-02		6.6541		0.47404		5.7805		0.47456		2.6246		0.32129
140	1.0000e-02		3.9981		0.47553		11.1624		0.36523		5.7364		0.18737
145	1.0000e-02		3.4729		0.44211		6.8704		0.51170		2.8826		0.24527
150	1.0000e-02		2.8496		0.47361		5.1381		0.52799		3.0086		0.25836
155	1.0000e-02		2.5051		0.51884		10.2938		0.56396		4.2268		0.22805
160	1.0000e-02		3.2761		0.47118		6.9170		0.44230		3.1194		0.23817
165	1.0000e-02		3.1598		0.48743		5.4686		0.54607		2.5543		0.28041
170	1.0000e-02		3.2365		0.48655		4.4212		0.54244		3.2732		0.22748
175	1.0000e-02		3.0208		0.50369		6.2545		0.53068		2.6020		0.30869
180	1.0000e-02		3.0459		0.41499		24.3455		0.20720		13.3958		0.00000
185	1.0000e-02		3.8738		0.42870		22.8332		0.31425		18.9984		0.12541
190	1.0000e-02		3.0487		0.44061		4.5838		0.49019		2.7814		0.26957
195	1.0000e-02		3.1138		0.46078		6.7559		0.53637		2.9473		0.28933
200	1.0000e-02		2.5057		0.48419		8.3863		0.55375		2.5830		0.28568
205	1.0000e-02		2.9080		0.52925		6.5446		0.61154		4.3166		0.26487
210	1.0000e-02		2.4736		0.52514		6.5426		0.53412		2.4693		0.29714
215	1.0000e-02		2.3605		0.53652		5.2426		0.58082		2.8873		0.27773
220	1.0000e-02		2.9793		0.48429		7.2994		0.47949		3.1479		0.29232
225	1.0000e-03		2.4836		0.51635		5.7365		0.49322		3.1161		0.26853
230	1.0000e-03		2.3123		0.51389		5.2984		0.52021		2.8991		0.28854
235	1.0000e-03		1.8020		0.56464		5.2993		0.58579		3.0537		0.30827
240	1.0000e-03		1.7876		0.54114		4.9303		0.56876		3.3268		0.31990
245	1.0000e-03		1.6797		0.55108		4.6367		0.54541		3.0789		0.29487
250	1.0000e-03		1.8650		0.53520		5.1785		0.58067		3.0197		0.30383
255	1.0000e-03		2.2321		0.56560		5.3127		0.60964		3.2645		0.33245
260	1.0000e-03		1.7925		0.55045		5.5338		0.60133		3.0532		0.31974
265	1.0000e-03		2.1241		0.53730		5.5014		0.58929		2.9712		0.32471
270	1.0000e-03		2.1510		0.56972		5.9393		0.63743		3.1042		0.33785
275	1.0000e-03		1.9259		0.53830		5.4581		0.59998		2.8823		0.31445
280	1.0000e-04		1.8990		0.55716		5.1499		0.56689		2.9812		0.29541
285	1.0000e-04		1.9507		0.56005		5.1891		0.60090		3.1120		0.29442
290	1.0000e-04		1.7969		0.55596		5.2878		0.59455		3.0006		0.30153
295	1.0000e-04		1.7560		0.57251		5.3534		0.60647		3.1761		0.30421
300	1.0000e-04		2.0315		0.58776		5.2310		0.57120		3.0940		0.29441
305	1.0000e-04		1.9218		0.57048		5.4831		0.59207		3.0583		0.30068
310	1.0000e-04		1.9349		0.57916		5.3240		0.59168		3.1242		0.29688
315	1.0000e-04		1.8163		0.57140		5.4830		0.61856		3.1243		0.31271
320	1.0000e-04		2.0156		0.56122		5.4561		0.62401		3.3844		0.30456
325	1.0000e-04		1.7796		0.54697		5.2512		0.58212		3.0221		0.29578
330	1.0000e-04		1.6922		0.56058		5.1254		0.57885		2.9923		0.29637
335	1.0000e-05		1.9609		0.57504		5.5047		0.60675		2.9765		0.31223
340	1.0000e-05		1.6240		0.58902		5.3955		0.60493		3.0986		0.31042
345	1.0000e-05		1.8041		0.60136		5.9462		0.63834		3.1793		0.32824
350	1.0000e-05		1.7900		0.55712		5.5913		0.60632		2.9567		0.30959
355	1.0000e-05		2.0380		0.56971		5.6038		0.61560		3.1146		0.31954
360	1.0000e-05		2.0506		0.57650		5.3020		0.60037		2.9774		0.30579
365	1.0000e-05		1.8127		0.61348		5.8276		0.63730		3.6165		0.32432
370	1.0000e-05		1.8289		0.57918		5.4520		0.60310		3.1326		0.30648
375	1.0000e-05		1.7044		0.58794		5.4803		0.61828		3.2599		0.31952
380	1.0000e-05		2.1323		0.56112		5.3739		0.59308		3.2516		0.31083
385	1.0000e-05		1.9383		0.56627		5.6577		0.62711		3.2844		0.31996
390	1.0000e-06		1.8156		0.57327		5.5032		0.60337		3.1721		0.30572
395	1.0000e-06		2.1008		0.56023		5.4877		0.59565		3.0666		0.30367
400	1.0000e-06		1.6339		0.58416		5.8061		0.63160		3.1303		0.32840
405	1.0000e-06		1.8243		0.58716		5.5629		0.60626		3.1238		0.31421
410	1.0000e-06		2.0986		0.57219		5.6574		0.60875		2.9465		0.31583
415	1.0000e-06		1.7263		0.57132		5.2615		0.60416		3.2035		0.30893
420	1.0000e-06		1.7300		0.57875		5.5791		0.61145		3.2460		0.31325
425	1.0000e-06		1.6178		0.56479		5.2867		0.59018		3.1532		0.29699
430	1.0000e-06		1.9590		0.56555		5.5720		0.61549		3.3598		0.31105
435	1.0000e-06		1.9150		0.55894		5.9771		0.64898		3.5904		0.31675
440	1.0000e-06		1.8696		0.55957		5.3677		0.59711		3.4026		0.29308
445	1.0000e-07		2.6453		0.56951		5.3476		0.56780		3.1334		0.29517
450	1.0000e-07		1.5738		0.57534		5.1363		0.57857		3.2738		0.29167
455	1.0000e-07		1.8379		0.57241		5.6685		0.62548		3.2044		0.31878
460	1.0000e-07		1.8913		0.59628		5.4103		0.60684		3.0290		0.30944
465	1.0000e-07		2.0625		0.60735		5.6305		0.61882		3.2960		0.30233
470	1.0000e-07		2.0901		0.58271		5.8257		0.63336		3.6578		0.32149
475	1.0000e-07		1.8359		0.57080		5.6396		0.61333		3.4209		0.31061
480	1.0000e-07		2.1357		0.56544		5.4200		0.61722		3.3490		0.30495
485	1.0000e-07		2.1084		0.56297		5.2529		0.58928		3.1917		0.29475
490	1.0000e-07		1.7935		0.55767		5.1568		0.58551		3.1711		0.29260
495	1.0000e-07		2.0574		0.57448		5.2587		0.60282		3.2740		0.30037
500	1.0000e-08		1.7536		0.56795		5.2936		0.58652		3.3781		0.29482
505	1.0000e-08		1.9581		0.54525		5.3626		0.59127		3.1410		0.29602
510	1.0000e-08		2.5460		0.56079		5.4358		0.59136		3.4915		0.29538
515	1.0000e-08		1.8732		0.56976		5.4842		0.58952		3.0874		0.30351
520	1.0000e-08		1.7099		0.56130		5.5125		0.59737		2.9912		0.30739
525	1.0000e-08		1.6832		0.57433		5.5025		0.59654		2.9879		0.30227
530	1.0000e-08		2.4272		0.56617		5.3492		0.59167		3.3397		0.29108
535	1.0000e-08		2.1873		0.57402		5.4349		0.61228		3.5436		0.30317
540	1.0000e-08		1.7155		0.57283		5.7363		0.64330		3.5090		0.31567
545	1.0000e-08		1.9183		0.56174		5.4098		0.60639		3.2409		0.30555
550	1.0000e-08		2.2577		0.57042		5.5994		0.63332		3.4962		0.32569
555	1.0000e-08		2.0382		0.55795		5.3798		0.58636		3.1196		0.29927
560	1.0000e-08		2.0121		0.56965		5.3050		0.58501		3.2134		0.29488
565	1.0000e-08		2.2960		0.57106		5.5011		0.61597		3.3071		0.31144
570	1.0000e-08		1.6978		0.56730		5.3244		0.61282		3.4928		0.30166
575	1.0000e-08		1.7651		0.55443		5.1545		0.57543		3.3659		0.28949
580	1.0000e-08		1.9828		0.55555		5.6975		0.63262		3.3869		0.32047
585	1.0000e-08		2.3697		0.57428		5.6022		0.63925		3.5452		0.32421
590	1.0000e-08		2.0077		0.59432		5.4953		0.62114		3.2513		0.31230
595	1.0000e-08		1.8760		0.57253		5.2754		0.60336		3.2193		0.30474
600	1.0000e-08		2.0267		0.57683		5.1266		0.57400		3.2206		0.29544
605	1.0000e-08		1.8841		0.56687		5.6417		0.61360		3.4033		0.30893
610	1.0000e-08		1.9013		0.54512		5.4584		0.60155		3.2397		0.31553
615	1.0000e-08		1.8351		0.58781		5.6546		0.62630		3.2692		0.31819
620	1.0000e-08		1.7218		0.56946		5.5644		0.59272		3.2583		0.31000
625	1.0000e-08		1.7259		0.58841		5.7240		0.63541		3.6029		0.32252
630	1.0000e-08		1.8782		0.58788		5.4162		0.59741		2.9601		0.30746
635	1.0000e-08		1.9474		0.56605		6.2149		0.66027		3.7241		0.33043
640	1.0000e-08		1.8404		0.55303		5.5522		0.62152		3.2246		0.31758
645	1.0000e-08		2.0711		0.55939		5.7592		0.64818		3.6134		0.32735
650	1.0000e-08		1.5876		0.57143		5.2893		0.58350		3.2408		0.30025
655	1.0000e-08		2.4379		0.55426		5.3724		0.56773		2.9855		0.29278
660	1.0000e-08		1.7435		0.59968		5.5021		0.58630		3.3477		0.29551
665	1.0000e-08		1.6734		0.58688		5.2434		0.60265		3.2492		0.30076
670	1.0000e-08		2.0512		0.55471		6.0739		0.62374		3.3976		0.31579
675	1.0000e-08		1.6940		0.57178		5.9818		0.63256		3.3424		0.32302
680	1.0000e-08		2.2474		0.58289		5.6058		0.62893		3.6837		0.30811
685	1.0000e-08		1.7668		0.57754		5.3437		0.60591		3.1081		0.30517
690	1.0000e-08		1.7707		0.56637		5.4337		0.56935		3.2231		0.29353
695	1.0000e-08		1.7260		0.58071		5.1913		0.56822		3.3136		0.29010
700	1.0000e-08		2.5147		0.56742		5.5803		0.59981		3.6816		0.29611
705	1.0000e-08		1.8776		0.57283		5.5972		0.62108		3.5205		0.32205
710	1.0000e-08		1.6005		0.56162		5.4179		0.60105		3.1431		0.31284
715	1.0000e-08		1.7325		0.56171		5.5761		0.61830		3.2595		0.31963
720	1.0000e-08		1.6921		0.59129		5.6437		0.61419		3.3032		0.31458
725	1.0000e-08		1.5833		0.56230		5.7048		0.62787		3.2274		0.31447
730	1.0000e-08		2.0153		0.57772		5.3436		0.60072		3.1874		0.30312
735	1.0000e-08		1.5973		0.57239		5.3168		0.60679		2.9605		0.30489
740	1.0000e-08		2.1257		0.56410		5.4102		0.61548		3.2056		0.31230
745	1.0000e-08		1.7664		0.59757		5.3763		0.57343		2.8626		0.29311
750	1.0000e-08		1.6808		0.57739		5.5971		0.59893		3.1308		0.30665
755	1.0000e-08		1.7332		0.57620		6.1022		0.61485		3.0396		0.31768
760	1.0000e-08		1.5257		0.56752		5.4599		0.59521		3.1566		0.30218
765	1.0000e-08		1.6227		0.59428		5.3598		0.59740		3.4018		0.30896
770	1.0000e-08		1.7713		0.54421		5.3031		0.59126		3.1714		0.30142
775	1.0000e-08		2.0256		0.58987		6.0822		0.65411		3.6870		0.33215
780	1.0000e-08		2.0105		0.58651		5.4903		0.60385		3.3449		0.30375
785	1.0000e-08		1.7323		0.58522		5.5934		0.61233		3.3269		0.31302
790	1.0000e-08		1.8790		0.58207		5.5102		0.61340		3.4339		0.31298
795	1.0000e-08		1.8418		0.56629		5.3462		0.58845		3.1442		0.29889
800	1.0000e-08		1.7159		0.60518		5.4951		0.60936		3.2323		0.31330
805	1.0000e-08		2.1794		0.58571		5.7585		0.63589		3.3777		0.32672
810	1.0000e-08		2.1558		0.59597		5.3705		0.60789		3.1931		0.30117
815	1.0000e-08		1.6720		0.58612		5.3747		0.59945		3.5751		0.29704
820	1.0000e-08		1.7006		0.57431		5.3079		0.58139		3.0975		0.30257
825	1.0000e-08		2.0032		0.57181		5.2865		0.58764		3.1503		0.29855
830	1.0000e-08		1.9372		0.57706		5.2343		0.58649		3.1251		0.29676
835	1.0000e-08		1.9486		0.57445		5.6190		0.62835		3.5222		0.32475
840	1.0000e-08		1.6104		0.59642		6.0468		0.64135		3.4671		0.32639
845	1.0000e-08		1.6872		0.51843		5.5233		0.55857		2.9222		0.29487
850	1.0000e-08		1.9201		0.56880		6.0051		0.63394		3.5077		0.32375
855	1.0000e-08		1.8218		0.57692		5.5906		0.58077		2.9590		0.29884
860	1.0000e-08		2.0884		0.60250		5.7876		0.63871		3.3036		0.32961
865	1.0000e-08		2.1566		0.57205		5.2589		0.57623		2.9419		0.29937
870	1.0000e-08		1.7801		0.57689		5.6446		0.60845		3.1215		0.31702
875	1.0000e-08		1.8219		0.59681		5.5614		0.62293		3.3599		0.32055
880	1.0000e-08		1.8922		0.55466		5.6213		0.62148		3.1591		0.31424
885	1.0000e-08		2.0512		0.56655		5.4566		0.61458		3.5459		0.30849
890	1.0000e-08		2.3286		0.56657		5.7968		0.64275		3.5310		0.33340
895	1.0000e-08		2.1576		0.58499		5.6592		0.61906		3.6010		0.30883
900	1.0000e-08		2.0747		0.58054		5.5057		0.60444		3.2692		0.30817
905	1.0000e-08		1.8958		0.57268		5.7256		0.62160		3.5434		0.30520
910	1.0000e-08		1.6091		0.54876		5.3327		0.59591		3.2898		0.29800
915	1.0000e-08		1.8002		0.57991		5.5837		0.62641		3.5560		0.31224
920	1.0000e-08		1.6348		0.59977		5.6126		0.62396		3.5937		0.31398
925	1.0000e-08		2.1342		0.56939		5.3788		0.59135		3.0766		0.30534
930	1.0000e-08		2.0228		0.55543		5.4696		0.61737		3.2437		0.30796
935	1.0000e-08		1.9582		0.56112		5.3930		0.61171		3.6822		0.29127
940	1.0000e-08		1.8597		0.57956		5.6451		0.62918		3.4721		0.31248
945	1.0000e-08		2.1789		0.58294		5.5813		0.62433		3.6651		0.30187
