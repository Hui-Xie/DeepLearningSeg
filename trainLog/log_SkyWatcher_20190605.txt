Program ID of SkyWatcher Network training:14311

Program command: 
 ['/home/hxie1/Projects/OvarianCancer/TrainSkyWatcher.py', '/home/hxie1/temp_netParameters/OvarianCancer/SkyWatcher', '/home/hxie1/data/OvarianCancerCT/Extract_uniform/trainImages_ROI_147_281_281', '/home/hxie1/data/OvarianCancerCT/Extract_uniform/testImages_ROI_147_281_281', '/home/hxie1/data/OvarianCancerCT/Extract_uniform/patientResponseDict.json']

Major program changes: 
                      

Experiment setting for Image3d ROI to response:
Input CT data: 147*281*281  3D CT raw image ROI
segmentation label: 127*255*255 segmentation label with value (0,1,2) which erases lymph node label

This is a multi-task learning. 

Predictive Model: 1,  first 3-layer dense conv block with channel size 24.
                  2,  and 6 dense conv DownBB blocks,  each of which includes a stride 2 conv and 3-layers dense conv block; 
                  3,  and 3 fully connected layers  changes the tensor into size 2*1;
                  4,  final a softmax for binary classification;
                  Total network learning parameters are 236K.
                  Network architecture is referred at https://github.com/Hui-Xie/OvarianCancer/blob/master/Image3dPredictModel.py

response Loss Function:   focus loss  with weight [3.3, 1.4] for [0,1] class separately, as [0,1] uneven distribution.
segmentation loss function: focus loss  with weight [1.0416883685076772, 39.37007874015748, 68.39945280437757] for label (0, 1, 2)

Data:   training data has 130 patients, and test data has 32 patients with training/test rate 80/20.
        We used patient ID as index to order all patients data, and then used about the first 80% of patients as training data, 
        and the remaining 20% of patients as test data. 
        Sorting with patient ID is to make sure the division of training and test set is blind to the patient's detailed stage, 
        shape and size of cancer.  
        Therefore you will see that patient IDs of all test data are beginning at 8 or 9. 
        This training/test division is exactly same with segmentation network experiment before. 

Training strategy:  50% probability of data are mixed up with beta distribution with alpha =0.4, to feed into network for training. 
                    No other data augmentation, and no dropout.  

                    Learning Scheduler:  Reduce learning rate on  plateau, and learning rate patience is 30 epochs.                                

            

Program starting Time: 2019-06-05 17:04:04.521911
Info: netPath = /home/hxie1/temp_netParameters/OvarianCancer/SkyWatcher

Now program get 130 input files.
Now program get 32 input files.
TrainData Input:  batchSize=4, depth=147, height=281, width=281, NumClassfication=2

TestData Input:  batchSize=4, depth=147, height=281, width=281, NumClassfication=2

Info: the size of bottle neck in the net = 6* (1, 3, 3)

Info: program uses Mixup with alpha=0.4, and mixupProb = 0.5.
Network trains from scratch.
Network has total 27,596 parameters.
Infor: Cross Entropy Weight: [3.3333333333333335, 1.4285714285714286] for label[0, 1]
Infor: Segmentation Cross Entropy Weight: [1.0416883685076772, 39.37007874015748, 68.39945280437757] for label (0, 1, 2)
Info: program will use 4 GPUs.
Loss Functions List: FocalCELoss with weight of 1; 	FocalCELoss with weight of 1; 
Hints: Test Dice_0 is the dice coeff for all non-zero labels
Hints: Test Dice_1 is for primary cancer(green), 	
 test Dice_2 is for metastasis(yellow), 	
 and test Dice_3 is for invaded lymph node(brown).
Hints: Test TPR_0 is the TPR for all non-zero labels
Hints: Test TPR_1 is for primary cancer(green), 	
 TPR_2 is for metastasis(yellow), 	
 and TPR_3 is for invaded lymph node(brown).

Dice is based on the 2D segmented slices from weak annotation, not 3D dice.


Hints: Optimal_Result = Yes = 1,  Optimal_Result = No = 0 


Epoch	TrLoss	Dice0	Dice1	Dice2	TPR_0	TPR_1	TPR_2	Accur	TsLoss	Dice0	Dice1	Dice2	TPR_0	TPR_1	TPR_2	Accur
0	0.6859	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.6787	0.035	0.000	1.000	0.000	0.7500
1	0.4753	0.000	0.000	0.000	0.000	0.000	0.000	1.0000	0.5979	0.040	0.000	1.000	0.000	0.7500
2	0.8875	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.4516	0.038	0.000	1.000	0.000	1.0000
3	0.9498	0.000	0.000	0.000	0.000	0.000	0.000	0.2500	0.5826	0.168	0.000	1.000	0.000	1.0000
4	0.6750	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.9719	0.179	0.000	1.000	0.000	0.2500
5	0.8899	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.6442	0.148	0.000	1.000	0.000	1.0000
6	0.7970	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.4568	0.059	0.000	1.000	0.000	1.0000
7	0.5913	0.000	0.000	0.000	0.000	0.000	0.000	1.0000	0.7064	0.076	0.000	1.000	0.000	0.7500
8	0.5004	0.000	0.000	0.000	0.000	0.000	0.000	1.0000	0.8323	0.127	0.000	1.000	0.000	0.7500
9	0.7429	0.000	0.000	0.000	0.000	0.000	0.000	0.7500	0.6541	0.097	0.000	1.000	0.000	0.7500
10	0.8222	0.121	0.043	0.999	0.034	0.7500	0.8398	0.148	0.000	1.000	0.000	0.7500
11	0.6439	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.7503	0.160	0.000	1.000	0.000	0.7500
12	0.7332	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.5444	0.041	0.000	1.000	0.000	1.0000
13	0.7063	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.8556	0.127	0.000	1.000	0.000	0.5000
14	0.6934	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.6831	0.064	0.000	1.000	0.000	0.5000
15	0.7776	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.4608	0.050	0.000	1.000	0.000	1.0000
16	0.8651	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.6252	0.200	0.000	1.000	0.000	1.0000
17	0.6435	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.6334	0.071	0.000	1.000	0.000	0.7500
18	0.8987	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.6368	0.047	0.000	1.000	0.000	0.7500
19	0.5373	0.000	0.000	0.000	0.000	0.000	0.000	1.0000	0.5035	0.027	0.000	1.000	0.000	1.0000
20	0.7160	0.071	0.111	1.000	0.072	0.5000	0.4688	0.037	0.000	1.000	0.000	1.0000
21	0.7021	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.4688	0.046	0.000	1.000	0.000	1.0000
22	0.6630	0.000	0.000	0.000	0.000	0.000	0.000	0.2500	0.7940	0.099	0.000	1.000	0.000	0.5000
23	0.5829	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.5294	0.052	0.000	1.000	0.000	1.0000
24	0.6405	0.000	0.000	0.000	0.000	0.000	0.000	0.7500	0.7792	0.170	0.000	1.000	0.000	0.7500
25	0.6540	0.180	0.137	1.000	0.092	1.0000	0.6014	0.146	0.000	1.000	0.000	1.0000
26	0.4642	0.000	0.000	0.000	0.000	0.000	0.000	1.0000	0.7222	0.091	0.000	1.000	0.000	0.7500
27	0.7683	0.000	0.000	0.000	0.000	0.000	0.000	0.5000	0.6434	0.149	0.000	1.000	0.000	1.0000
28	0.4411	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.7613	0.059	0.000	1.000	0.000	0.7500
29	0.7614	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.7969	0.155	0.000	1.000	0.000	0.7500
30	0.6933	0.143	0.178	1.000	0.118	0.7500	0.7071	0.052	0.000	1.000	0.000	0.7500
31	0.8382	0.000	0.000	0.000	0.000	0.000	0.000	0.0000	0.6584	0.180	0.000	1.000	0.000	1.0000
