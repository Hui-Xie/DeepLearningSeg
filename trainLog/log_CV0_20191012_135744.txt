=============training from sratch============
Program ID: 4827

Program command: 
 ['TrainSegV3d_ROI.py', '/home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI', '1', '/home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/nrrd_npy', '/home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/labels_npy', '0', '3,2,1']

Major program changes: 
      1  3D V model for primary cancer ROI;
      2  Uniform ROI size: 51*171*171 in z,y,x directon;
      3  Total 36 patient data, in which training data 24 patients, validation 6 patients, and test 6 patients;
      4  all 36 patients data have 50-80% 3D label;
      5  Dice coefficient is 3D dice coefficient against corresponding 3D ground truth;
      6  training data augmentation in the fly: affine in XY plane, translation in Z direction;
      7  In the bottle neck of V model, the latent vector has size of 512*2*9*9;
      Sep 16th, 2019:
      1   add dynamic loss weight according trainin  data;
      2   refine learning rate decay.
      Sep 21st, 2019
      1   add improved Boundary Loss2, and inherit the previous learningrate of network of pure CELoss;
      Sep 23rd, 2019:
      1   improve mean of boundary loss limited on the A,B regions;
      2   use log(segProb) instead of segProb in the boudary loss;
      3   CrossEntropy weight reduces 0.01 per 5 epochs from 1 to 0.01, while boundary Loss weight increase 0.01 per 5 epochs from 0.01 to 1. 
      Sep 24th, 2019
      1   Use boundaryLoss1, which is considering the whole volume. 
      Sep 25th, 2019
      1   use boundaryLoss3, which is a stronger gradient signal to improve loss.
      2   unbalanced weight for class is applied on logP,and just use boundaryLoss3 with CELoss.
      3   use CELoss and boundaryLoss together.
      4   Use truncated DistanceCrossEntropy Loss alone;
      5   change LRScheduler into reduce into Plateau with initial LR=0.1
      Sep 26th, 2019
      1   Add one layer in the bottom of V model;
      2   Add residual connnection in each layer;
      Sep 30th, 2019
      1   With size-reduced ROI of size 51*149*149;
      2   reduce the translation of data augmentation;
      3   reduce all data into 35 patients, excluding a very blur patient.
      Oct 5th, 2019
      1   use uniform physical size 147mm*147mm*147mm, input pixel size: 49*147*147 with spacing size 3mm*1mm*1mm;
      2   change V model with inputsize 49*147*147
      Oct 6th, 2019
      1   add filter number to 48 at the first layer. 
      Oct 7th, 2019
      1   restore to 32 of number of filters in the first layer;
      2   add bottom number of filters to 1024, and keep down sample and add filter number together. 
      Oct 8th, 2019
      1   discard the cancer with size exceeding 147mm*147mm*147mm; Now remains 29 patients data; 
      Oct 9th, 2019
      1   In the first layer of V model, remove the residual link; 
           with the residula link at first layer: Tr dice:54%, Validation Dice 27%, Test Dice 56%;  Not good.
      2   the final output layer, change into 1*1*1 convolution, instead of 3*3*3 convolution;
      3   add labelConsistencyLoss, it use 64 dimension feature extracted from 2 ends of V model:
           It gets stable Training Dice 61%, validation Dice 27%, and test dice 49%, for fold 0 in the fixed physical size:147mm*147mm*147mm; 
      Oct 11th, 2019
      1   use feature tensor just from the output end of V model. It is 32 dimensions.
          It gets stable Training Dice 61%, validation Dice 23%, and test dice 49%, for fold 0 in the fixed physical size:147mm*147mm*147mm; 
      2   windows size for consistency loss changes to 3;
      Oct 12th, 2019
      1   change image window level to 100/50; relauch training;
      

          
         

Discarded changes:                  
          

Program starting Time: 2019-10-12 13:57:44.840530
Info: netPath = /home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI/20191012_135744

Info: this is the 0th fold leave for test in the 6-fold cross-validation.

Info: batchSize = 6

Info: useLabelConsistencyLoss = False and searchWindowSize= 3

Net parameters is saved in  /home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI/20191012_135744.
program re-initializes all input files list, which will lead previous all K_fold cross validation invalid.
6-fold cross validation: the 0th fold is for test, the 1th fold is for validation, remaining folds are for training.

training dataset: total 19 image files.

validation dataset: total 5 image files.

test dataset: total 5 image files.
Total 19 training files  extracted from /home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/labels_npy
0 has 18433812 elements, with a rate of  0.9162854777808447 
1 has 1684167 elements, with a rate of  0.08371452221915532 
loss weight = tensor([ 1.0000, 10.9454])
Network has total 113,191,074 parameters.


************** Table of Training Log **************
Epoch	LearningRate		TrainingLoss	Dice		ValidationLoss	Dice		TestLoss	Dice
0	1.0000e-02		17.4495		0.11799		8.6305		0.00049		15.4643		0.00019
5	1.0000e-02		10.5279		0.05575		6.5487		0.07230		9.7257		0.21995
10	1.0000e-02		5.9384		0.41693		18.2261		0.11274		10.2806		0.30037
15	1.0000e-02		6.2274		0.38831		16.6653		0.10360		6.4827		0.35787
20	1.0000e-02		4.9726		0.39787		14.7702		0.13723		5.8162		0.33945
25	1.0000e-02		5.8969		0.40755		7.9779		0.13012		4.1784		0.43481
30	1.0000e-02		3.6785		0.44943		5.3820		0.20925		5.3879		0.38106
35	1.0000e-02		3.6619		0.47723		4.5741		0.21823		5.2384		0.37076
40	1.0000e-02		4.7977		0.44933		8.0308		0.16134		7.9672		0.34104
45	1.0000e-02		4.4083		0.44127		3.4812		0.21403		5.7921		0.35798
50	1.0000e-02		3.6459		0.42990		5.0097		0.21027		5.1106		0.39480
55	1.0000e-02		3.6041		0.43562		2.3750		0.29799		3.6226		0.44397
60	1.0000e-02		5.8311		0.46587		6.0478		0.22811		6.4011		0.36815
65	1.0000e-02		3.9710		0.45443		17.0927		0.12465		12.4352		0.27815
70	1.0000e-02		3.9807		0.40995		6.7270		0.14858		5.3783		0.43461
75	1.0000e-02		3.4775		0.48925		4.9867		0.15045		4.2361		0.45178
80	1.0000e-02		3.5582		0.50041		9.3895		0.18540		5.1745		0.40393
85	1.0000e-02		4.7305		0.42628		5.4073		0.19875		5.5167		0.38832
90	1.0000e-02		4.5025		0.41753		4.5915		0.20143		5.6052		0.36549
95	1.0000e-02		3.6397		0.45813		3.3159		0.33720		3.1874		0.50118
100	1.0000e-02		3.2362		0.52042		3.1107		0.20577		4.0962		0.44492
105	1.0000e-02		3.3194		0.48504		2.0291		0.32209		4.5279		0.50418
110	1.0000e-02		3.6174		0.51462		6.3493		0.09506		8.4254		0.46180
115	1.0000e-02		2.6119		0.56172		5.2415		0.19590		4.1076		0.46173
120	1.0000e-02		2.8973		0.53399		4.0371		0.18742		3.6996		0.44747
125	1.0000e-02		2.3160		0.53629		3.4720		0.16424		3.0891		0.50795
130	1.0000e-02		2.5596		0.51644		5.5675		0.14489		5.6315		0.46611
135	1.0000e-02		3.1536		0.54275		4.9351		0.25585		3.7618		0.41149
140	1.0000e-02		2.7449		0.49110		7.1200		0.14355		6.3241		0.40871
145	1.0000e-02		2.5954		0.49469		5.0086		0.21168		4.0046		0.43993
150	1.0000e-02		3.8908		0.43283		3.9947		0.20824		5.3227		0.44917
155	1.0000e-02		3.8876		0.51523		3.5132		0.25705		3.8865		0.46345
160	1.0000e-03		3.4910		0.55483		6.4023		0.11385		5.3129		0.39483
165	1.0000e-03		3.0086		0.51916		3.6126		0.23307		3.6534		0.45969
170	1.0000e-03		3.3594		0.52117		3.0185		0.25293		3.7286		0.50384
175	1.0000e-03		3.3253		0.48874		3.3486		0.22718		3.2064		0.51333
180	1.0000e-03		2.7838		0.54688		2.9931		0.25077		3.4190		0.51577
185	1.0000e-03		2.8569		0.53782		3.1308		0.25441		3.7901		0.51300
190	1.0000e-03		3.3462		0.52604		3.5638		0.23940		3.9203		0.52235
195	1.0000e-03		2.7123		0.52099		3.2718		0.23636		3.2667		0.50088
200	1.0000e-03		2.4251		0.53408		3.3700		0.22248		3.2252		0.49662
205	1.0000e-03		3.6476		0.54140		3.1920		0.23787		3.4422		0.49294
210	1.0000e-03		2.5481		0.50619		3.5615		0.22226		3.3892		0.48123
215	1.0000e-04		2.5163		0.53892		2.7619		0.26802		3.3475		0.50639
220	1.0000e-04		3.1955		0.53460		2.9769		0.25803		3.3621		0.50281
