=============training from sratch============
Program ID: 18673

Program command: 
 ['TrainSegV3d_ROI.py', '/home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI', '1', '/home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/nrrd_npy', '/home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/labels_npy', '0', '3', '1']

Major program changes: 
      1  3D V model for primary cancer ROI;
      2  Uniform ROI size: 51*171*171 in z,y,x directon;
      3  Total 36 patient data, in which training data 24 patients, validation 6 patients, and test 6 patients;
      4  all 36 patients data have 50-80% 3D label;
      5  Dice coefficient is 3D dice coefficient against corresponding 3D ground truth;
      6  training data augmentation in the fly: affine in XY plane, translation in Z direction;
      7  In the bottle neck of V model, the latent vector has size of 512*2*9*9;
      Sep 16th, 2019:
      1   add dynamic loss weight according trainin  data;
      2   refine learning rate decay.
      Sep 21st, 2019
      1   add improved Boundary Loss2, and inherit the previous learningrate of network of pure CELoss;
      Sep 23rd, 2019:
      1   improve mean of boundary loss limited on the A,B regions;
      2   use log(segProb) instead of segProb in the boudary loss;
      3   CrossEntropy weight reduces 0.01 per 5 epochs from 1 to 0.01, while boundary Loss weight increase 0.01 per 5 epochs from 0.01 to 1. 
      Sep 24th, 2019
      1   Use boundaryLoss1, which is considering the whole volume. 
      Sep 25th, 2019
      1   use boundaryLoss3, which is a stronger gradient signal to improve loss.
      2   unbalanced weight for class is applied on logP,and just use boundaryLoss3 with CELoss.
      3   use CELoss and boundaryLoss together.
      4   Use truncated DistanceCrossEntropy Loss alone;
      5   change LRScheduler into reduce into Plateau with initial LR=0.1
      Sep 26th, 2019
      1   Add one layer in the bottom of V model;
      2   Add residual connnection in each layer;
      Sep 30th, 2019
      1   With size-reduced ROI of size 51*149*149;
      2   reduce the translation of data augmentation;
      3   reduce all data into 35 patients, excluding a very blur patient.
      Oct 5th, 2019
      1   use uniform physical size 147mm*147mm*147mm, input pixel size: 49*147*147 with spacing size 3mm*1mm*1mm;
      2   change V model with inputsize 49*147*147
      Oct 6th, 2019
      1   add filter number to 48 at the first layer. 
      Oct 7th, 2019
      1   restore to 32 of number of filters in the first layer;
      2   add bottom number of filters to 1024, and keep down sample and add filter number together. 
      Oct 8th, 2019
      1   discard the cancer with size exceeding 147mm*147mm*147mm; Now remains 29 patients data; 
      Oct 9th, 2019
      1   In the first layer of V model, remove the residual link; 
           with the residula link at first layer: Tr dice:54%, Validation Dice 27%, Test Dice 56%;  Not good.
      2   the final output layer, change into 1*1*1 convolution, instead of 3*3*3 convolution;
      3   add labelConsistencyLoss, it use 64 dimension feature extracted from 2 ends of V model:
           It gets stable Training Dice 61%, validation Dice 27%, and test dice 49%, for fold 0 in the fixed physical size:147mm*147mm*147mm; 
      Oct 11th, 2019
      1   use feature tensor just from the output end of V model. It is 32 dimensions.
          It gets stable Training Dice 61%, validation Dice 23%, and test dice 49%, for fold 0 in the fixed physical size:147mm*147mm*147mm; 
      2   windows size for consistency loss changes to 3;
      Oct 12th, 2019
      1   change image window level to 100/50; relaunch training;
      2   change consistencyLoss to use ground truth for comparing diff of feature vector;
      Oct 13th, 2019
      1    use conistencyLoss3: ((G1-G2)-(P1-P2))**2 as loss.
       
      

          
         

Discarded changes:                  
          

Program starting Time: 2019-10-13 08:16:56.451528
Info: netPath = /home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI/20191013_081656

Info: this is the 0th fold leave for test in the 6-fold cross-validation.

Info: batchSize = 1

Info: useConsistencyLoss = True and searchWindowSize= 7

Net parameters is saved in  /home/hxie1/temp_netParameters/OvarianCancer/SegV3d_ROI/20191013_081656.
6-fold cross validation: the 0th fold is for test, the 1th fold is for validation, remaining folds are for training.

training dataset: total 19 image files.

validation dataset: total 5 image files.

test dataset: total 5 image files.
Total 19 training files  extracted from /home/hxie1/data/OvarianCancerCT/primaryROI1_1_3/labels_npy
0 has 18433812 elements, with a rate of  0.9162854777808447 
1 has 1684167 elements, with a rate of  0.08371452221915532 
loss weight = tensor([ 1.0000, 10.9454])
Network has total 113,191,074 parameters.


************** Table of Training Log **************
Epoch	LearningRate		TrainingLoss	Dice		ValidationLoss	Dice		TestLoss	Dice
0	1.0000e-02		6.0643		0.11137		2.8157		0.00250		13.9026		0.00142
5	1.0000e-02		3.8366		0.28858		2.7275		0.06846		3.0747		0.26426
10	1.0000e-02		3.0205		0.31250		8.4153		0.09848		4.6971		0.35522
15	1.0000e-02		2.1664		0.33784		16.5740		0.07883		9.2348		0.25889
20	1.0000e-02		2.8389		0.36991		1.8232		0.16685		1.8901		0.38187
25	1.0000e-02		2.7153		0.33830		6.1531		0.08865		4.6892		0.28283
30	1.0000e-02		2.1109		0.36780		2.8611		0.12273		2.5844		0.32375
35	1.0000e-02		1.8874		0.41495		5.2286		0.17553		4.0285		0.37004
40	1.0000e-02		1.4932		0.47581		1.3291		0.25354		1.7327		0.43122
45	1.0000e-02		2.4831		0.38717		15.3144		0.08874		6.8391		0.26820
50	1.0000e-02		2.2481		0.38826		2.3828		0.18272		2.1858		0.38524
55	1.0000e-02		1.4855		0.46203		2.3720		0.17774		2.3368		0.38858
60	1.0000e-02		1.0546		0.50949		4.0289		0.12390		4.8440		0.29690
65	1.0000e-02		1.5734		0.46307		1.5336		0.21662		1.4980		0.44399
70	1.0000e-02		2.3676		0.46310		7.6439		0.14054		7.1497		0.27510
75	1.0000e-02		1.3311		0.48291		3.2072		0.11819		2.9056		0.36995
80	1.0000e-02		1.3098		0.50236		2.7766		0.11796		1.7325		0.44745
85	1.0000e-02		1.2660		0.49829		3.1442		0.12128		2.5211		0.38250
90	1.0000e-02		0.8513		0.56346		5.0327		0.14489		4.8346		0.23290
95	1.0000e-03		1.5141		0.49589		4.3210		0.07339		4.1828		0.30831
100	1.0000e-03		1.0051		0.55788		3.3043		0.14817		2.8834		0.31259
105	1.0000e-03		0.9761		0.57503		2.5185		0.16806		1.9223		0.42900
110	1.0000e-03		0.9448		0.58122		2.6817		0.17291		1.8018		0.42725
115	1.0000e-03		0.8468		0.62579		2.8472		0.16942		1.5059		0.46297
120	1.0000e-03		0.8200		0.59610		2.9501		0.16984		1.8712		0.40953
125	1.0000e-03		0.8697		0.58717		1.6499		0.22755		1.5457		0.43169
130	1.0000e-03		0.6906		0.62138		3.5025		0.14247		2.0234		0.42324
135	1.0000e-03		0.7146		0.65341		2.4902		0.17270		1.6374		0.45372
140	1.0000e-03		0.6256		0.67214		2.9110		0.17510		1.5234		0.45908
145	1.0000e-03		0.6521		0.63964		2.7734		0.17784		1.5685		0.45025
150	1.0000e-04		0.8267		0.61470		2.1430		0.24304		2.1056		0.42887
155	1.0000e-04		0.6671		0.67658		2.6558		0.19641		2.3011		0.36113
160	1.0000e-04		0.6180		0.72853		2.2393		0.20601		1.7156		0.42989
165	1.0000e-04		0.5724		0.67213		1.9880		0.22147		1.7689		0.42641
170	1.0000e-04		0.7625		0.65566		2.6542		0.20426		2.1231		0.39801
175	1.0000e-04		0.6410		0.65927		2.1016		0.21305		1.3782		0.47827
180	1.0000e-04		0.7332		0.68660		2.9447		0.19894		1.7172		0.45155
185	1.0000e-04		0.6387		0.65104		2.6487		0.20486		1.4149		0.47661
190	1.0000e-04		0.5742		0.68667		2.7080		0.17772		1.5392		0.44416
195	1.0000e-04		0.5709		0.65349		2.1508		0.19542		1.5265		0.46339
200	1.0000e-04		0.6267		0.64034		2.2167		0.18426		1.6959		0.43487
205	1.0000e-05		0.7083		0.67922		2.3287		0.17547		1.3861		0.47435
210	1.0000e-05		0.6257		0.66483		2.8047		0.18403		1.5995		0.45039
215	1.0000e-05		0.4820		0.72034		2.3480		0.17891		1.7308		0.44669
220	1.0000e-05		0.5083		0.71700		2.4726		0.17953		1.6604		0.45708
225	1.0000e-05		0.4948		0.65390		2.5879		0.18218		2.2515		0.42867
230	1.0000e-05		0.6549		0.65018		2.6090		0.19842		1.5278		0.46415
